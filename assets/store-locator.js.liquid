var storeLocator=function(a,b){function h(){return map=new google.maps.Map(document.getElementById("store_map"),e)}function i(b){a.getJSON("{{ 'stores.json' | asset_url }}",function(e){a.each(e,function(a,e){var f=j(b,e),g=m(b,e,f);c.push(f),d.push(g),k(e)})})}function j(a,b){var c=new google.maps.Marker({id:b.id,position:{lat:b.lat,lng:b.lng},map:a,title:b.id.toString(),icon:f});return l(c),c}function k(b){var c='<li class="store" data-target-id="'+b.id+'"><a href="#_">'+b.address+"</a></li>";a(".store-list").append(c)}function l(a){a.addListener("mouseover",function(){a.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){a.setAnimation(null)},1e3)})}function m(a,b,c){var d=b.address,e=infowindow=new google.maps.InfoWindow({content:d});return c.addListener("click",function(){n(),e.open(a,c)}),e}function n(){for(item in d)d[item].close()}function o(b){a('.store-list .store[data-target-id="'+b+'"]').addClass("hidden");for(item in c)if(c[item].id==b){c[item].setMap(null);break}}function p(b,d){a('.store-list .store[data-target-id="'+b+'"]').removeClass("hidden");for(item in c)if(c[item].id==b){c[item].setMap(d);break}}function q(a,b){"none"!==a&&"0"!==a||(a=999999);for(item in c){var d=c[item],e=r(g.getPosition().lat(),g.getPosition().lng(),d.getPosition().lat(),d.getPosition().lng());e>a?o(d.id):p(d.id,b)}}function r(a,c,d,e){var f=3959,g=s(d-a),h=s(e-c),a=s(a),d=s(d),i=b.sin(g/2)*b.sin(g/2)+b.sin(h/2)*b.sin(h/2)*b.cos(a)*b.cos(d),j=2*b.atan2(b.sqrt(i),b.sqrt(1-i)),k=f*j;return k}function s(a){return a*b.PI/180}function t(b){var c=new google.maps.Geocoder,d=a("#address_search").val(),e=a("#within_distance").val();return g&&(g.setMap(null),g=null),c.geocode({address:d,componentRestrictions:{country:"US"}},function(a,c){if(c==google.maps.GeocoderStatus.OK){var f=a[0].geometry.location.lat(),h=a[0].geometry.location.lng();g=new google.maps.Marker({position:{lat:f,lng:h},title:"Your position"}),b.panTo({lat:f,lng:h}),b.setZoom(10),q(e,b)}else alert("Error: Looking for address: "+d)}),!1}function u(){a(".store-list").on("mouseenter",".store",function(b){var c=a(this).attr("data-target-id");x(c,!0)}),a(".store-list").on("mouseleave",".store",function(b){var c=a(this).attr("data-target-id");x(c,!1)})}function v(b){a(".store-list").on("click",".store",function(c){var d=a(this).attr("data-target-id");w(d,b)})}function w(a,b){for(d in c){var d=c[d];d.id==a&&(b.panTo({lat:d.getPosition().lat(),lng:d.getPosition().lng()}),b.setZoom(13))}}function x(a,b){for(marker in c)c[marker].id==a&&(b?c[marker].setAnimation(google.maps.Animation.BOUNCE):c[marker].setAnimation(null))}var c=[],d=[],e={center:{lat:36.2121659,lng:-102.7122811},zoom:4},f="{{ 'pin.png' | asset_url }} ",g=null,y={};return y.init=function(){var a;a=h(),i(a),u(),v(a)},y.search=function(){t(map)},y}(jQuery,Math);